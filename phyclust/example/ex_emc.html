<!DOCTYPE html>
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <meta name="description" content="Phylogenetic Clustering">
  <meta name="keywords" content="phylogenetic,clustering,phyloclustering,phylogenetics,evolution,phylogeny,tree,unrooted,statistics,model-based,R,phyclust,ms,seq-gen,PAML,baseml,Hap-Clustering,EM,finite mixture model">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="../../style/wcc_main.css" media="screen">
  <link rel="stylesheet" href="../../style/wcc_navbar.css" media="screen">

<!-- Google Analytics Tracking. -->
<script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-2556553-3']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
</script>

<script src="../../style/w3data.js"></script>
<script src="../../style/linenumbers.js"></script>

</head>


<body bgcolor="#f8f4e7">

<div w3-include-html="./preamble_head_nav.html"></div>
<div class="container-fluid">
  <div w3-include-html="./preamble_head_nav_tabs.html"></div>
  <ul class="breadcrumb"> //
    <li><a href="../index.html">phyclust Home</a></li> /
    <li><a href="../example.html">Example</a></li> /
    <li class="active">ex_emc</li>
  </ul>
</div>


<xmp theme="readable" style="display:none;">


#### <code>.EMC</code> -- Examples of <code>.EMControl()</code></font></b>

<code>.EMC</code> is a reserved object storing all options for
<code>phyclust()</code>, <code>find.best()</code>, and other related
functions, and it is created by a function <code>.EMControl()</code>
providing default values for EM steps and initialization.
Examples are given in the following, copy and paste to R to see the results,
and the details are available by using <code>help(.EMControl)</code>.

```
.EMControl()          # This gives a return object as .EMC.
.show.option()        # This prints all options. 

# These lines provide EMC.1 which is exactly the same as
# EMC.2 using "HKY85" for the Q matrix, and time t is varied
# for clusters. EMC.1 and EMC.2 can be used in phyclust() or
# find.best().
EMC.1 <- .EMC
EMC.1$substitution.model <- "HKY85"
EMC.1$identifier <- "EV"
EMC.2 <- .EMControl(substitution.model = "HKY85",
                    identifier = "EV")

# These 4 lines provide EMC.3 which is exactly the same as
# EMC.4 using "SNP_JC69" for the Q matrix, HAMMING distance
# for initialization, and the data should be SNP sequences.
EMC.3 <- .EMC
EMC.3$substitution.model <- "SNP_JC69"
EMC.3$edist.model <- "HAMMING"
EMC.3$code.type <- "SNP"
EMC.4 <- .EMControl(substitution.model = "SNP_JC69",
                    edist.model = "HAMMING",
                    code.type = "SNP")

# This line changes more options including initialization
# procedure, initialization method, model for the Q matrix,
# identifier, and the EM algorithm.
EMC.5 <- .EMControl(init.procedure = "RndEM",
                    init.method = "randomNJ",
                    substitution.model = "K80",
                    identifier = "EV",
                    em.method = "ACEM")

# This line uses a convergent condition looser than the
# default, and originally conditions in optim() for the
# Nelder-Mead method.
EMC.6 <- .EMControl(EM.eps = 1e-8,
                    nm.abstol.Mu.given.QA = 1e-16,
                    nm.reltol.Mu.given.QA = 1e-8,
                    nm.maxit.Mu.given.QA = 500,
                    nm.abstol.QA.given.Mu = 1e-16,
                    nm.reltol.QA.given.Mu = 1e-8,
                    nm.maxit.QA.given.Mu = 500)
```


---
<div w3-include-html="../preamble_tail_date.html"></div>

</xmp>

<script type="text/javascript" src="../../style/strapdown.js"></script>
<script>
  w3IncludeHTML();
</script>

</body>
</html>


